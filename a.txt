import os
import shutil
import pandas as pd

def move_files_based_on_excel(excel_file, base_path):
    # Load the Excel file
    df = pd.read_excel(excel_file)
    
    for index, row in df.iterrows():
        original_dir = os.path.join(base_path, str(row['A']))  # Directory to check
        new_dir = os.path.join(original_dir, str(row['B']))  # New directory to create
        
        if os.path.exists(original_dir) and os.path.isdir(original_dir):
            os.makedirs(new_dir, exist_ok=True)  # Create new directory if it doesn't exist
            
            # Move files from original_dir to new_dir
            for file_name in os.listdir(original_dir):
                file_path = os.path.join(original_dir, file_name)
                if os.path.isfile(file_path):  # Ensure it's a file
                    shutil.move(file_path, os.path.join(new_dir, file_name))
            
            print(f"Moved files from {original_dir} to {new_dir}")
        else:
            print(f"Directory does not exist: {original_dir}")

# Example usage
excel_file = "data.xlsx"  # Change this to your actual Excel file path
base_path = "C:\\your_base_directory"  # Change this to your actual base directory
move_files_based_on_excel(excel_file, base_path)
