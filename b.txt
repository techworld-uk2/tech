import pandas as pd
from openpyxl import load_workbook

# Load the input text file
with open("input.txt", "r") as file:
    input_values = set(line.strip() for line in file.readlines())

# Load the Excel file
excel_file = "your_excel_file.xlsx"  # Update with your file name
sheet_name = "Sheet1"  # Update if needed

df = pd.read_excel(excel_file, sheet_name=sheet_name, engine='openpyxl')

# Load the workbook and sheet
wb = load_workbook(excel_file)
ws = wb[sheet_name]

# Iterate over rows starting from row 13
for row in range(13, ws.max_row + 1):
    control_reference = ws[f'I{row}'].value  # Get value from column I
    if control_reference is not None:
        ws[f'W{row}'] = "Passed" if str(control_reference).strip() in input_values else "Failed"

# Save the updated Excel file
wb.save(excel_file)
wb.close()

print("Script Status updated successfully.")
